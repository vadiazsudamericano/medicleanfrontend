<!-- RUTA: src/app/detalle-herramienta/detalle-herramienta.component.html -->

<div class="detalle-container">

  <ng-container *ngIf="herramienta as h; else cargando">

    <div class="tarjeta-herramienta">
      
      <div class="header">
        <h1 class="nombre">{{ h.nombre }}</h1>
        <!-- 
          CAMBIO CLAVE #1:
          Añadimos paréntesis y un OR ('||').
          (h.estado?.toLowerCase() || '') asegura que si el resultado es undefined,
          se convierte en una cadena vacía '' ANTES de intentar hacer el .split().
        -->
        <div class="estado" [ngClass]="(h.estado?.toLowerCase() || '').split(' ')[0] || ''">
          {{ h.estado }}
        </div>
      </div>
  
      <div class="seccion">
        <h3>Descripción</h3>
        <p>{{ h.descripcion || 'No disponible.' }}</p>
      </div>
  
      <div class="seccion">
        <h3>Uso Principal</h3>
        <p>{{ h.uso || 'No disponible.' }}</p>
      </div>
  
      <div class="seccion">
        <h3>Proceso de Esterilización</h3>
        <!-- 
          CAMBIO CLAVE #2:
          Usamos el operador de coalescencia nula ('??').
          (h.proceso?.length ?? 0) asegura que si el resultado es undefined,
          se convierte en 0 ANTES de compararlo con > 0.
        -->
        <ul *ngIf="(h.proceso?.length ?? 0) > 0; else sinProceso">
          <li *ngFor="let paso of h.proceso">{{ paso }}</li>
        </ul>
        <ng-template #sinProceso>
          <p>No hay un proceso registrado.</p>
        </ng-template>
      </div>
      
    </div>

  </ng-container>

  <!-- Plantilla de carga (sin cambios) -->
  <ng-template #cargando>
    <div class="mensaje-carga">
      <p>{{ mensajeCarga }}</p>
    </div>
  </ng-template>

  <!-- Botón de volver (sin cambios) -->
  <div class="acciones">
    <a routerLink="/escaner" class="boton-volver">← Volver al Escáner</a>
  </div>

</div>