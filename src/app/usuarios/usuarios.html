<!-- RUTA: src/app/usuarios/usuarios.html -->

<div class="tabla-container">
  <h2>Gesti√≥n de Usuarios</h2>
  <table class="tabla-usuarios">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Email</th>
        <th>Rol</th>
        <th *ngIf="currentUserRol === 'admin'">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of usuarios">
        <td data-label="Nombre">{{ user.nombre }}</td>
        <td data-label="Email">{{ user.email }}</td>
        <td data-label="Rol">{{ user.role }}</td>
        <td data-label="Acciones" *ngIf="currentUserRol === 'admin'">
          <div class="acciones-btns">
            <button class="btn-delete" (click)="eliminarUsuario(user.id)">
              <i class="fas fa-trash"></i> Eliminar
            </button>
            <button class="btn-role" (click)="mostrarSelector(user.id)">
              <i class="fas fa-user-cog"></i> Cambiar rol
            </button>
          </div>

          <!-- Selector visual de rol -->
          <div *ngIf="mostrarSelectRol && selectedUserId === user.id" class="rol-selector">
            <select [(ngModel)]="nuevoRol">
              <option value="" disabled selected>Selecciona un rol</option>
              <option value="admin">Admin</option>
              <option value="user">User</option>
            </select>
            <div class="rol-botones">
              <button (click)="aplicarCambioRol()">Aplicar</button>
              <button class="cancelar" (click)="cancelarCambio()">Cancelar</button>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div *ngIf="mensaje" class="notificacion" [ngClass]="tipoMensaje">{{ mensaje }}</div>
